n=23124752709251540295223539055016666725519601394190204936103033967567276224025662041534523470246937716961480559493778461696574824923340085781705881751570255975900445559082241203063291835145055796205057093550855306437863389066188627462544312375990109352334335874008716880331678233401564155505910465753100406564178916841352650197056389559038346622739216663865604505142571364848697449955069616209697614852890166730123027707685297231354669197791508969525274191100891965790466719859932546832164265170369079603805036992279714716390445589229552360989684144040664241776778327614775651192621096636616220650411868182114652457903
e=65537
c=8734659822721641572997882019370332335754088242287506123413141824636579711861911122559911243821208648919998870271481805807195676522007042383597077387350888827809721745517013079890310771413411300282654051777387065399841579857645963686536427704857085369358882263810610803716262096259470210170122824517677151815056611375980601348614007177962717097262476987470133209242083752986356354192197377425848020117043177942787935086083713272608157596492522688233352832483968858542996223259366594003019616667987320520808122366411936602071613089597905106106481490128173998715530322419741271162082071029014084003433689301527649902114

def egcd(a, b):
    x,y, u,v = 0,1, 1,0
    while a != 0:
        q, r = b//a, b%a
        m, n = x-u*q, y-v*q
        b,a, x,y, u,v = a,r, u,v, m,n
    gcd = b
    return gcd, x, y

def modinv(a, m):
    gcd, x, y = egcd(a, m)
    if gcd != 1:
        return None  # modular inverse does not exist
    else:
        return x % m

k = 31
if(egcd(k, n)[0] is 1):
    ktoe = pow(k,e,n)
    newc = (ktoe*c) % n
    print("here is cp:", newc)
else:
    print("k is not relatively prime to n.")

kinv = modinv(k,n)
oracleout=17287825930299184761285786110936186192463896686577224444808385400496628261371502146522322711646926051593271621013490592851382348140428541750841841380189187885151819597828515583554014617537913119891624204497061635880852768803555533065228617956858072222129375957952406230451593460826124228869052106815376299550299232728748948025906337715594900612772076237812617678699162793342221855260805879034533743288810307689482901276197418487480898572348187066442655269848905484313492417090377934291931578405873539720520995756497412914257694600112099367153983549120761630470846545781165884905535428871193038396961796058324404227903
m = (oracleout * kinv) % n
print("actual message : ", m)
